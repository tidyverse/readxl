<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Column Names • readxl</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Column Names">
<meta name="robots" content="noindex">
<script defer data-domain="readxl.tidyverse.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">readxl</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.4.3.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/cell-and-column-types.html">Cell and Column Types</a></li>
    <li><a class="dropdown-item" href="../articles/column-names.html">Column Names</a></li>
    <li><a class="dropdown-item" href="../articles/multiple-header-rows.html">Multiple Header Rows</a></li>
    <li><a class="dropdown-item" href="../articles/readxl-workflows.html">readxl Workflows</a></li>
    <li><a class="dropdown-item" href="../articles/sheet-geometry.html">Sheet Geometry</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2022/03/readxl-1-4-0/">Version 1.4.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2018/12/readxl-1-2-0/">Version 1.2.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2018/04/readxl-1-1-0/">Version 1.1.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.rstudio.com/blog/readxl-1-0-0/">Version 1.0.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.rstudio.com/blog/readxl-0-1-0/">Version 0.1.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tidyverse/readxl/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Column Names</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidyverse/readxl/blob/main/vignettes/articles/column-names.Rmd" class="external-link"><code>vignettes/articles/column-names.Rmd</code></a></small>
      <div class="d-none name"><code>column-names.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="column-names-via-col_names">Column names via <code>col_names</code><a class="anchor" aria-label="anchor" href="#column-names-via-col_names"></a>
</h2>
<p>readxl has always let you specify <code>col_names</code> explicitly
at the time of import:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/readxl_example.html">readxl_example</a></span><span class="op">(</span><span class="st">"datasets.xlsx"</span><span class="op">)</span>, sheet <span class="op">=</span> <span class="st">"chickwts"</span>,</span>
<span>  col_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chick_weight"</span>, <span class="st">"chick_ate_this"</span><span class="op">)</span>, skip <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 71 × 2</span></span></span>
<span><span class="co">#&gt;    chick_weight chick_ate_this</span></span>
<span><span class="co">#&gt;           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>          179 horsebean     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>          160 horsebean     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>          136 horsebean     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>          227 horsebean     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>          217 horsebean     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>          168 horsebean     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>          108 horsebean     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>          124 horsebean     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>          143 horsebean     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>          140 horsebean     </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 61 more rows</span></span></span></code></pre></div>
<p>But users have long wanted a way to specify a name repair
<em>strategy</em>, as opposed to enumerating the actual column
names.</p>
</div>
<div class="section level2">
<h2 id="built-in-levels-of--name_repair">Built-in levels of <code>.name_repair</code><a class="anchor" aria-label="anchor" href="#built-in-levels-of--name_repair"></a>
</h2>
<p>As of v1.2.0, readxl provides the <code>.name_repair</code> argument,
which affords control over how column names are checked or repaired.</p>
<p>The <code>.name_repair</code> argument in <code><a href="../reference/read_excel.html">read_excel()</a></code>,
<code><a href="../reference/read_excel.html">read_xls()</a></code>, and <code><a href="../reference/read_excel.html">read_xlsx()</a></code> works exactly the
same way as it does in <a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link"><code>tibble::tibble()</code></a>
and <a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link"><code>tibble::as_tibble()</code></a>.
The reasoning behind the name repair strategy is laid out in <a href="https://design.tidyverse.org/names.html" class="external-link">design.tidyverse.org</a>.</p>
<p>readxl’s default is <code>.name_repair = "unique"</code>, which
ensures each column has a unique name. If that is already true of the
column names, readxl won’t touch them.</p>
<p>The value <code>.name_repair = "universal"</code> goes further and
makes column names syntactic, i.e. makes sure they don’t contain any
forbidden characters or reserved words. This makes life easier if you
use packages like ggplot2 and dplyr downstream, because the column names
will “just work” everywhere and won’t require protection via backtick
quotes.</p>
<p>Compare the column names in these two calls. This shows the
difference between <code>"unique"</code> (names can contain spaces) and
<code>"universal"</code> (spaces replaced by <code>.</code>).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/readxl_example.html">readxl_example</a></span><span class="op">(</span><span class="st">"deaths.xlsx"</span><span class="op">)</span>,  range <span class="op">=</span> <span class="st">"arts!A5:F8"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 6</span></span></span>
<span><span class="co">#&gt;   Name          Profession   Age `Has kids` `Date of birth`    </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> David Bowie   musician      69 TRUE       1947-01-08 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Carrie Fisher actor         60 TRUE       1956-10-21 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Chuck Berry   musician      90 TRUE       1926-10-18 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: `Date of death` &lt;dttm&gt;</span></span></span>
<span></span>
<span><span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/readxl_example.html">readxl_example</a></span><span class="op">(</span><span class="st">"deaths.xlsx"</span><span class="op">)</span>, range <span class="op">=</span> <span class="st">"arts!A5:F8"</span>,</span>
<span>  .name_repair <span class="op">=</span> <span class="st">"universal"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; New names:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `Has kids` -&gt; `Has.kids`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `Date of birth` -&gt; `Date.of.birth`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `Date of death` -&gt; `Date.of.death`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 6</span></span></span>
<span><span class="co">#&gt;   Name   Profession   Age Has.kids Date.of.birth       Date.of.death      </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> David… musician      69 TRUE     1947-01-08 <span style="color: #949494;">00:00:00</span> 2016-01-10 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Carri… actor         60 TRUE     1956-10-21 <span style="color: #949494;">00:00:00</span> 2016-12-27 <span style="color: #949494;">00:00:00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Chuck… musician      90 TRUE     1926-10-18 <span style="color: #949494;">00:00:00</span> 2017-03-18 <span style="color: #949494;">00:00:00</span></span></span></code></pre></div>
<p>If you don’t want readxl to touch your column names at all, use
<code>.name_repair = "minimal"</code>.</p>
</div>
<div class="section level2">
<h2 id="pass-a-function-to--name_repair">Pass a function to <code>.name_repair</code><a class="anchor" aria-label="anchor" href="#pass-a-function-to--name_repair"></a>
</h2>
<p>The <code>.name_repair</code> argument also accepts a function –
pre-existing or written by you – or an anonymous formula. This function
must operate on a “names in, names out” basis.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## ALL CAPS! via built-in toupper()</span></span>
<span><span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="fu"><a href="../reference/readxl_example.html">readxl_example</a></span><span class="op">(</span><span class="st">"clippy.xlsx"</span><span class="op">)</span>, .name_repair <span class="op">=</span> <span class="va">toupper</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 2</span></span></span>
<span><span class="co">#&gt;   NAME                 VALUE    </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Name                 Clippy   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Species              paperclip</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Approx date of death 39083    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Weight in grams      0.9</span></span>
<span></span>
<span><span class="co">## lower_snake_case via a custom function</span></span>
<span><span class="va">my_custom_name_repair</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">nms</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"[.]"</span>, <span class="st">"_"</span>, <span class="va">nms</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/readxl_example.html">readxl_example</a></span><span class="op">(</span><span class="st">"datasets.xlsx"</span><span class="op">)</span>, n_max <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  .name_repair <span class="op">=</span> <span class="va">my_custom_name_repair</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">#&gt;   sepal_length sepal_width petal_length petal_width species</span></span>
<span><span class="co">#&gt;          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>          5.1         3.5          1.4         0.2 setosa </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>          4.9         3            1.4         0.2 setosa </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>          4.7         3.2          1.3         0.2 setosa</span></span>
<span></span>
<span><span class="co">## take first 3 characters via anonymous function</span></span>
<span><span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/readxl_example.html">readxl_example</a></span><span class="op">(</span><span class="st">"datasets.xlsx"</span><span class="op">)</span>,</span>
<span>  sheet <span class="op">=</span> <span class="st">"chickwts"</span>, n_max <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  .name_repair <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">.x</span>, start <span class="op">=</span> <span class="fl">1</span>, stop <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 2</span></span></span>
<span><span class="co">#&gt;     wei fee      </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>   179 horsebean</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>   160 horsebean</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>   136 horsebean</span></span></code></pre></div>
<p>This means you can also perform name repair in the style of base R or
another package, such as <code>janitor::make_clean_names()</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span></span>
<span>  <span class="va">SOME_SPREADSHEET</span>,</span>
<span>  .name_repair <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/make.names.html" class="external-link">make.names</a></span><span class="op">(</span><span class="va">.x</span>, unique <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span></span>
<span>  <span class="va">SOME_SPREADSHEET</span>,</span>
<span>  .name_repair <span class="op">=</span> <span class="fu">janitor</span><span class="fu">::</span><span class="va">make_clean_names</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>What if you have a spreadsheet with lots of missing column names?
Here’s how you could fall back to letter-based column names, for easier
troubleshooting.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span></span>
<span>  <span class="va">SOME_SPREADSHEET</span>,</span>
<span>  .name_repair <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nzchar</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span>, <span class="va">.x</span>, <span class="va">LETTERS</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span> </span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://hadley.nz" class="external-link">Hadley Wickham</a>, <a href="https://jennybryan.org" class="external-link">Jennifer Bryan</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

  </div></footer>
</body>
</html>
